/* Платежный модуль Tranzzo (сниппет)
* Совместим с MODX REVO 2.5.х (версии 2.х.х тоже должны быть совместимы, возможно с некоторыми поправками в коде)!
* Модуль требует наличие плагина ShopKeeper 3.0
* version 2.0
*/

==============================
Инструкция по настройке модуля
==============================

1. Необходимо создать 2-3 страницы:

*   страница оплаты через Tranzzo. (или вызвать снипет на странице уведомления о успешно сделаном заказе, тогда страницу можно не создавать)
    Вставить в поле "Содержимое ресурса" вызов сниппета:

    [[!tranzzo? action=`payment`]]

*   страница с сообщением об успешной оплате (с любым содержанием)
    Пример:

    Оплата заказа №[[+shk.id]] прошла успешно на сумму [[+shk.price]] [[+shk.currency]]

*   страница с сообщением об отмене оплаты.

*   страница для подтверждения оплаты. Вставить в поле "Содержимое ресурса" вызов сниппета:

    [[!tranzzo? action=`callback`]]

    P.S. при работе модуля ShopKeeper3 используется сниппет Formit для валидации формы оплаты,
    в вызове сниппета можно добавить хук tranzzo перед redirect, что позволит автоматически
    сделать редирект на форму с оплатой.

2. Заполнить параметры сниппета tranzzo:

page_paymentForm - id страницы формы оплаты

page_callback - id страницы приёма ответа сервера оплаты

page_result - id страницы для возврата на сайт


currency - Валюта магазина(3-х буквенный код валюты)


TRANZZO_POS_ID,
TRANZZO_API_KEY,
TRANZZO_API_SECRET,
TRANZZO_ENDPOINTS_KEY - получить у поставщика услуги


3. В меню ShopKeeper3 перейти в раздел настройки, выбрать "Методы оплаты". Вписать "Имя" - Tranzzo, "значение" - tranzzo.
Сохранить настройки, после чего в форме офомрления заказа появится в списке метод оплаты "Tranzzo"
